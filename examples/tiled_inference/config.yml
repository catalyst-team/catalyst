model_params:
  model: smp.FPN
  encoder_name: "resnext50_32x4d"
  classes: &num_classes 1

args:
  expdir: "tiled_inference"
  logdir: "./logs/tiled_inference"

stages:
  infer:
    state_params:
      num_epochs: 1

    data_params:
      batch_size: 16
      num_workers: 4
      image_path: "./tiled_inference/car_common.jpg"
      save_dir: "./logs/tiled_inference/predictions/"
      num_classes: *num_classes
      tile_size: [1280, 1920]
      tile_step: 1

    callback_params:
      loader:
        callback: CheckpointCallback
        resume: "./tiled_inference/checkpoint.pth"

    transform_params:

      transform: A.Compose
      transforms:
        - transform: A.Normalize
        - transform: catalyst.ToTensor
