


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dataflow &mdash; Catalyst 21.05 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DataParallel training (cpu, single/multi-gpu)" href="dp.html" />
    <link rel="prev" title="How to make X?" href="intro.html" /> 

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167094275-1"></script>
  <script src="../_static/js/googleanalytics.min.js"></script>
  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>

      <div class="main-menu">
        <ul>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButtonEcosystem" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://alchemy.host">
                  <span class=dropdown-title>Alchemy</span>
                  <p>Experiments logging & visualization</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">
                  <span class=dropdown-title>Catalyst</span>
                  <p>Accelerated deep learning R&D</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">
                  <span class=dropdown-title>Reaction</span>
                  <p>Convenient deep learning models serving</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div class="projects-dropdown">
              <a id="dropdownMenuButtonProjects" data-toggle="projects-dropdown">
                Projects
              </a>
              <div class="projects-dropdown-menu">
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">
                  <span class=dropdown-title>Codestyle</span>
                  <p>Joint R&D codestyle</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">
                  <span class=dropdown-title>Catalyst.Neuro</span>
                  <p>Catalyst.Team and TReNDS collaborative project</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">
                  <span class=dropdown-title>Classification</span>
                  <p>Image classification pipeline with transfer learning</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">
                  <span class=dropdown-title>Detection</span>
                  <p>Object detection pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">
                  <span class=dropdown-title>Segmentation</span>
                  <p>Image semantic segmentation pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">
                  <span class=dropdown-title>Catalyst.GAN</span>
                  <p>GAN pipelines</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/dl-course">Deep learning course</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="catalyst-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="catalyst-left-menu" id="catalyst-left-menu">
      <div class="catalyst-side-scroll">
        <div class="catalyst-menu catalyst-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="catalyst-left-menu-search">
            

            
              
              
                <div class="version">
                  <a href="https://catalyst-team.github.io/catalyst/versions.html">21.05</a>
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Catalyst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart 101</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#minimal-examples">Minimal examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/migrating_from_other.html">Migrating from other libraries</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-a-pytorch-framework-for-accelerated-deep-learning-r-d-ad9621e4ca88?source=friends_link&amp;sk=885b4409aecab505db0a63b06f19dcef">Catalyst — Accelerated Deep Learning R&amp;D</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ddp.html">Distributed training tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/runner.html">Runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/engine.html">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/callback.html">Callback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/metric.html">Metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/logger.html">Logger</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">How to make X?</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dataflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="dp.html">DataParallel training (cpu, single/multi-gpu)</a></li>
<li class="toctree-l1"><a class="reference internal" href="amp.html">Mixed precision training</a></li>
<li class="toctree-l1"><a class="reference internal" href="ddp.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_components.html">Multiple components</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_keys.html">Multiple input and output keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="early_stopping.html">Early stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="checkpointing.html">Model checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Model debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="optuna.html">Optuna integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="finetuning.html">Finetuning (multistage runs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_api.html">Config API</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/callbacks.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib.html">Contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/runners.html">Runners</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribution guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md">How to start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#acknowledgments">Acknowledgments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="catalyst-container">
      <div class="catalyst-page-level-bar" id="catalyst-page-level-bar">
        <div class="catalyst-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="catalyst-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Dataflow</li>
    
    
      <li class="catalyst-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/catalyst-team/catalyst/blob/master/docs/faq/data.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="catalyst-shortcuts-wrapper" id="catalyst-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="catalyst-content-wrap" class="catalyst-content-wrap">
        <div class="catalyst-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="catalyst-article" class="catalyst-article">
              
  <div class="section" id="dataflow">
<h1>Dataflow<a class="headerlink" href="#dataflow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="base-dataflow">
<h2>Base dataflow<a class="headerlink" href="#base-dataflow" title="Permalink to this headline">¶</a></h2>
<p>Catalyst uses the “key-value is all you need” approach.
In other words, the output of your Dataset/Dataloader should be a key-value (python <cite>dict</cite>).</p>
<p>Example of dataflow:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDataset</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__get_item__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">logits</span>

<span class="k">class</span> <span class="nc">MyRunner</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># on this step we also have self.batch = batch = {&quot;features&quot;: ..., &quot;targets&quot;: ...}</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">})</span>
        <span class="c1"># this is useful for other components of the pipeline</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">SupervisedRunner</span></code> has data preprocessing features to transform
tuple/list-based data into key-value.</p>
</div>
<p>Such approach is easily extensible for any number of features, targets and
very convenient to read, thanks to “automatic naming documentation” - keys for the values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDataset</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__get_item__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;extra_features&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">extra_features</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">logits</span>

<span class="k">class</span> <span class="nc">MyRunner</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># on this step we also have</span>
        <span class="c1"># self.batch = batch = {&quot;features&quot;: ..., &quot;extra_features&quot;: ...,&quot;targets&quot;: ...}</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">],</span> <span class="n">batch</span><span class="p">[</span><span class="s2">&quot;extra_features&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">update</span><span class="p">()</span><span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">})</span>
        <span class="c1"># this is useful for other components of the pipeline</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Moreover, if some of the features are not required anymore -
you don’t have to rewrite your code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDataset</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__get_item__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;extra_features&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">logits</span>

<span class="k">class</span> <span class="nc">MyRunner</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># on this step we also have</span>
        <span class="c1"># self.batch = batch = {&quot;features&quot;: ..., &quot;extra_features&quot;: ...,&quot;targets&quot;: ...}</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">})</span>
        <span class="c1"># this is useful for other components of the pipeline</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Key-value storage also can be used to store the datasets/loaders for the experiment.
In this case we also need to use <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code> to ensure correct epoch handling -
that your model will firstly train on some <code class="docutils literal notranslate"><span class="pre">train</span></code> dataset
and only then will be evaluated on some <code class="docutils literal notranslate"><span class="pre">valid</span></code> dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Catalyst uses the following “automatic naming documentation” for loader keys handling:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">loader_key</span></code> starts with “train” - is’s train datasoure, we need to run forward and backward passes on it.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">loader_key</span></code> starts with “valid” - is’s validation datasoure, we need to run forward, but not the backward pass on it.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">loader_key</span></code> starts with “infer” - is’s inference datasoure, we need to run forward, but not the backward pass on it.</p></li>
</ul>
</div>
<div class="section" id="multiple-datasources">
<h2>Multiple datasources<a class="headerlink" href="#multiple-datasources" title="Permalink to this headline">¶</a></h2>
<p>Thanks to key-value approach,
it’s possible to handle any number of datasets/loader
without code changes or tricks with Datasets concatenation, etc:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">train2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span>
    <span class="s2">&quot;train2&quot;</span><span class="p">:</span> <span class="n">train2_loader</span><span class="p">,</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">,</span>
    <span class="s2">&quot;valid2&quot;</span><span class="p">:</span> <span class="n">valid2_loader</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>What is even more interesting, you could also do something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">train2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">,</span>
    <span class="s2">&quot;train2&quot;</span><span class="p">:</span> <span class="n">train2_loader</span><span class="p">,</span>
    <span class="s2">&quot;valid2&quot;</span><span class="p">:</span> <span class="n">valid2_loader</span><span class="p">,</span>

<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Once again, it’s also valid to do something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">train2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">concat_datasets</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">train2_loader</span><span class="p">),</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">concat_datasets</span><span class="p">(</span><span class="n">valid_loader</span><span class="p">,</span> <span class="n">valid2_loader</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="loader-for-model-selection">
<h2>Loader for model selection<a class="headerlink" href="#loader-for-model-selection" title="Permalink to this headline">¶</a></h2>
<p>In case of multiple loaders, you could select one of them for model selection
with <code class="docutils literal notranslate"><span class="pre">valid_loader</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_metric</span></code> and <code class="docutils literal notranslate"><span class="pre">minimize_valid_metric</span></code> params in the <code class="docutils literal notranslate"><span class="pre">runner.train</span></code>.
For example, to use <code class="docutils literal notranslate"><span class="pre">valid2</span></code> loaders as your
model selection one you could do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">train2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid2_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span>
    <span class="s2">&quot;train2&quot;</span><span class="p">:</span> <span class="n">train2_loader</span><span class="p">,</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">,</span>
    <span class="s2">&quot;valid2&quot;</span><span class="p">:</span> <span class="n">valid2_loader</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">valid_loader</span><span class="o">=</span><span class="s2">&quot;valid2&quot;</span><span class="p">,</span>
    <span class="n">valid_metric</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span>
    <span class="n">minimize_valid_metric</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, Catalyst doesn’t suppose to use
<code class="docutils literal notranslate"><span class="pre">valid_loader</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_metric</span></code> and <code class="docutils literal notranslate"><span class="pre">minimize_valid_metric</span></code>
for model selection.</p>
</div>
</div>
<div class="section" id="metric-for-model-selection">
<h2>Metric for model selection<a class="headerlink" href="#metric-for-model-selection" title="Permalink to this headline">¶</a></h2>
<p>Suppose, you are using set of different metrics in your pipeline:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyRunner</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># on this step we also have self.batch = batch = {&quot;features&quot;: ..., &quot;targets&quot;: ...}</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">}</span>
        <span class="c1"># this is useful for other components of the pipeline</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">}</span>
<span class="n">model</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">AccuracyCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;logits&quot;</span><span class="p">,</span> <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;targets&quot;</span><span class="p">,</span> <span class="n">topk</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You could select one for model selection with <code class="docutils literal notranslate"><span class="pre">valid_loader</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_metric</span></code>
and <code class="docutils literal notranslate"><span class="pre">minimize_valid_metric</span></code> params in the <code class="docutils literal notranslate"><span class="pre">runner.train</span></code>.
For example, to use <code class="docutils literal notranslate"><span class="pre">accuracy01</span></code> metric as your model selection one you could do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyRunner</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># on this step we also have self.batch = batch = {&quot;features&quot;: ..., &quot;targets&quot;: ...}</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">}</span>
        <span class="c1"># this is useful for other components of the pipeline</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">}</span>
<span class="n">model</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="c1"># as far as we would like to maximize our model accuracy...</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">valid_loader</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span>
    <span class="n">valid_metric</span><span class="o">=</span><span class="s2">&quot;accuracy01&quot;</span><span class="p">,</span>
    <span class="n">minimize_valid_metric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">AccuracyCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;logits&quot;</span><span class="p">,</span> <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;targets&quot;</span><span class="p">,</span> <span class="n">topk</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, Catalyst doesn’t suppose to use
<code class="docutils literal notranslate"><span class="pre">valid_loader</span></code>, <code class="docutils literal notranslate"><span class="pre">valid_metric</span></code> and <code class="docutils literal notranslate"><span class="pre">minimize_valid_metric</span></code>
for model selection.</p>
</div>
</div>
<div class="section" id="use-part-of-the-data">
<h2>Use part of the data<a class="headerlink" href="#use-part-of-the-data" title="Permalink to this headline">¶</a></h2>
<p>If you would like to use only some part of your data from the loader
(for example, you would like to overfit for one small portion of the data to check your pipeline),
you could use <code class="docutils literal notranslate"><span class="pre">BatchLimitLoaderWrapper</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">BatchLimitLoaderWrapper</span><span class="p">(</span><span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="n">num_batches</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">)</span>
</pre></div>
</div>
<p>As a more user-friendly approach with <code class="docutils literal notranslate"><span class="pre">runner.train</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="c1"># here we overfit for one batch per loader</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span> <span class="n">overfit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>And more convenient and customizable way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">valid_loader</span> <span class="o">=</span> <span class="n">MyDataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">train_loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">valid_loader</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">MyRunner</span><span class="p">()</span>
<span class="c1"># here we overfit for 10 batches in `train` loader</span>
<span class="c1"># and half of the `valid` loader</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">BatchOverfitCallback</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">valid</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>If you haven’t found the answer for your question, feel free to <a class="reference external" href="https://join.slack.com/t/catalyst-team-core/shared_invite/zt-d9miirnn-z86oKDzFMKlMG4fgFdZafw">join our slack</a> for the discussion.</p>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dp.html" class="btn btn-neutral float-right" title="DataParallel training (cpu, single/multi-gpu)" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="intro.html" class="btn btn-neutral" title="How to make X?" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Scitator.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="catalyst-content-right" id="catalyst-content-right">
          <div class="catalyst-right-menu" id="catalyst-right-menu">
            <div class="catalyst-side-scroll" id="catalyst-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Dataflow</a><ul>
<li><a class="reference internal" href="#base-dataflow">Base dataflow</a></li>
<li><a class="reference internal" href="#multiple-datasources">Multiple datasources</a></li>
<li><a class="reference internal" href="#loader-for-model-selection">Loader for model selection</a></li>
<li><a class="reference internal" href="#metric-for-model-selection">Metric for model selection</a></li>
<li><a class="reference internal" href="#use-part-of-the-data">Use part of the data</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://catalyst-team.com/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Ecosystem</a></li>
            <li><a class="nav-dropdown-item" href="https://alchemy.host">Alchemy</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">Catalyst</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">Reaction</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Projects</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">Catalyst.Neuro</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">Classification</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">Detection</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">Segmentation</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">Catalyst.GAN</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://catalyst-team.com/">Support</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
            <li><a href="https://www.patreon.com/catalyst_team" target="_blank">Patreon</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <div class="footer-social-icons">
            <a href="https://t.me/catalyst_team" target="_blank" class="telegram"></a>
            <a href="https://twitter.com/catalyst_core" target="_blank" class="twitter"></a>
            <a href="https://join.slack.com/t/catalyst-team-core/shared_invite/zt-d9miirnn-z86oKDzFMKlMG4fgFdZafw" target="_blank" class="ods"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="">Get Started</a>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/catalyst">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      catalystAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.catalyst-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>