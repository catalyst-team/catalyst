model_params:
  _target_:  Net

args:
  expdir: "_tests_ml_cmcscore"
  logdir: "./logs/cmc"


stages:
  trian:
    stage_params:
      main_metric: cmc01
      valid_loader: valid_query_gallery
      minimize_metric: false

    data_params:
      batch_size: 32
      num_workers: 0

    criterion_params:
      _target_:  TripletLoss
    optimizer_params:
      _target_:  Adam
      lr: 0.001
      weight_decay: 0.0001

    callbacks_params:
      cmc:
        _wrapper:
          _target_:  ControlFlowCallback
          loaders: valid_query_gallery
        _target_:  CMCScoreCallback
        topk_args:
          - 1
          - 5
